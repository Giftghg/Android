# 注册失败排查指南

## 🔍 问题诊断步骤

### 第一步：检查Flask后端是否运行
1. 确保Flask后端正在运行：
   ```bash
   cd backend
   python run.py
   ```
2. 应该看到：
   ```
   * Running on http://127.0.0.1:5000
   * Running on http://10.34.68.221:5000
   ```

### 第二步：测试网络连接
1. 在Android应用中，**长按登录按钮**进行网络测试
2. 查看Toast提示信息：
   - ✅ "网络连接正常" - 连接没问题
   - ❌ "网络连接失败" - 需要检查网络

### 第三步：查看详细日志
1. 在Android Studio中打开Logcat
2. 在过滤器中输入：`ApiClient|NetworkTest`
3. 尝试注册，查看详细日志输出

### 第四步：检查IP地址
1. 确认您的电脑IP地址是否正确
2. 在ApiClient.java中检查BASE_URL：
   ```java
   private static final String BASE_URL = "http://10.34.68.221:5000/api";
   ```
3. 如果IP地址不同，请修改为正确的IP

## 🐛 常见问题及解决方案

### 问题1：网络连接失败
**症状**：提示"网络连接失败"
**可能原因**：
- Flask后端未运行
- IP地址错误
- 防火墙阻止连接
- 手机和电脑不在同一网络

**解决方案**：
1. 确保Flask后端正在运行
2. 检查IP地址是否正确
3. 临时关闭防火墙测试
4. 确保手机和电脑连接同一WiFi

### 问题2：服务器响应异常
**症状**：提示"服务器响应异常"
**可能原因**：
- Flask服务端口被占用
- 数据库问题
- API接口错误

**解决方案**：
1. 检查Flask控制台错误信息
2. 重启Flask服务
3. 检查数据库是否正常

### 问题3：注册接口返回错误
**症状**：注册失败，有具体错误信息
**可能原因**：
- 用户名已存在
- 邮箱格式错误
- 密码太短
- 数据库连接问题

**解决方案**：
1. 尝试不同的用户名
2. 确保密码至少6位
3. 检查Flask后端日志

## 📱 调试技巧

### 1. 使用Logcat查看详细日志
在Android Studio中：
1. 打开Logcat窗口
2. 在过滤器中输入：`ApiClient`
3. 尝试注册，查看所有网络请求日志

### 2. 测试API接口
使用curl命令测试：
```bash
curl -X POST http://10.34.68.221:5000/api/register \
  -H "Content-Type: application/json" \
  -d '{"username": "testuser", "password": "123456", "email": "test@example.com"}'
```

### 3. 检查Flask后端日志
在Flask控制台查看：
- 是否收到请求
- 请求参数是否正确
- 数据库操作是否成功

## 🔧 快速修复

### 修复1：更新IP地址
如果您的电脑IP不是`10.34.68.221`，请修改ApiClient.java：
```java
private static final String BASE_URL = "http://您的IP:5000/api";
```

### 修复2：使用本地测试
如果网络有问题，可以临时使用本地地址：
```java
private static final String BASE_URL = "http://127.0.0.1:5000/api";
```

### 修复3：检查防火墙
确保Windows防火墙允许Python/Flask应用通过

## 📞 获取帮助

如果问题仍然存在，请提供以下信息：
1. Flask后端控制台输出
2. Android Logcat中的错误信息
3. 网络测试结果
4. 您的电脑IP地址

---

**提示**：长按登录按钮可以快速测试网络连接！ 